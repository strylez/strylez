<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pose Tracking Overlay</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-models@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose@latest"></script>
    <style>
        video {
            position: absolute;
            left: 0;
            top: 0;
            z-index: 1;
        }
        canvas {
            position: absolute;
            left: 0;
            top: 0;
            z-index: 2;
            pointer-events: none;
        }
        .overlay {
            position: absolute;
            transform: translate(-50%, -50%);
        }
    </style>
</head>
<body>
    <video id="video" width="640" height="480" autoplay></video>
    <canvas id="canvas" width="640" height="480"></canvas>
    <img class="overlay" id="overlay-image" src="path_to_image.png" style="display:none;" />

    <script>
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const overlayImage = document.getElementById('overlay-image');

        async function setupCamera() {
            const stream = await navigator.mediaDevices.getUserMedia({ video: true });
            video.srcObject = stream;
            return new Promise((resolve) => {
                video.onloadedmetadata = () => {
                    resolve(video);
                };
            });
        }

        async function loadPoseModel() {
            return await pose.Pose.create();
        }

        async function detectPose(pose) {
            const poses = await pose.estimatePoses(video);
            if (poses.length > 0) {
                const shoulder = poses[0].keypoints[11]; // Right shoulder
                const shoulder2 = poses[0].keypoints[12]; // Left shoulder

                drawOverlay(shoulder, shoulder2);
            }
            requestAnimationFrame(() => detectPose(pose));
        }

        function drawOverlay(shoulder, shoulder2) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const midlineX = (shoulder.position.x + shoulder2.position.x) / 2;
            const midlineY = (shoulder.position.y + shoulder2.position.y) / 2;
            overlayImage.style.left = midlineX + 'px';
            overlayImage.style.top = midlineY + 'px';
            overlayImage.style.display = 'block';
            ctx.drawImage(overlayImage, midlineX - overlayImage.width / 2, midlineY - overlayImage.height / 2);
        }

        async function main() {
            await setupCamera();
            const pose = await loadPoseModel();
            detectPose(pose);
        }

        main();
    </script>
</body>
</html>